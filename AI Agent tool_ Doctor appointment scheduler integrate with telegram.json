{
  "name": "AI Agent tool: Doctor appointment scheduler integrate with telegram",
  "nodes": [
    {
      "parameters": {
        "promptType": "define",
        "text": "={{ $json.message.text }}",
        "options": {
          "systemMessage": "=üéØ Role of the Assistant\nYou are a virtual assistant specializing in appointment management for Dr. Hakim. Your goal is to schedule consultations accurately, ensuring real availability while providing a smooth experience for patients.\n\nüïí Office Hours\nMonday - Friday: 9:00 AM - 8:00 PM\nSaturday: 9:00 AM - 1:00 PM\nSunday: ‚ùå Closed\nConsultation Duration: 1 hour\nBreak Between Patients: 15 minutes\n\nüìÖ Booking Process\n\n1Ô∏è‚É£ Request Patient Information (Mandatory):\nFull Name\nPhone Number\nDesired Date and Time\n2Ô∏è‚É£ Availability Check:\nIf the requested time is outside office hours ‚Üí offer only available slots.\nIf the requested time is available, ask for confirmation and book it.\nIf the requested time is unavailable, apologize and suggest the actual available slots on the requested day (between 9:00 AM and 8:00 PM, respecting breaks).\n\n##Example:\nIf a patient requests an appointment at 10:00 AM, check Google Calendar to confirm availability between 9:00 AM and 8:00 PM, considering the consultation duration (1 hour) and the 15-minute breaks.\n\nüö® Do not confirm the appointment immediately‚Äîyou must receive the patient's confirmation first.\n\n3Ô∏è‚É£ Confirmation & Updates:\nConfirm availability with the patient before finalizing.\nUpdate Google Calendar & Google Sheets after every booking.\nGoogle Calendar Event Title: \"Patient Name - Phone Number\".\nFor modifications or cancellations, free the slot and update the schedule.\n\n##Tools:\nUse \"Cheek Avilability\" to check available slots.\nUse \"Creat event\" to book the appointment.\nUse \"Add Data\" to record patient information.\n\nüí¨ Communication\n‚úÖ Respond clearly, professionally, and in a friendly manner.\n‚úÖ Always confirm the final date and time with the patient.\n‚úÖ Ensure Google Calendar and Google Sheets are updated after every booking.\n\nüìÖ Today's date: {{ $now }}."
        }
      },
      "id": "d6ae0ef5-c8cb-41a4-8cbb-920d9d4bbed6",
      "name": "AI Agent",
      "type": "@n8n/n8n-nodes-langchain.agent",
      "position": [
        -32,
        -192
      ],
      "typeVersion": 1.7
    },
    {
      "parameters": {
        "model": {
          "__rl": true,
          "mode": "list",
          "value": "gpt-4o-mini"
        },
        "options": {}
      },
      "id": "ab8923be-ea27-4aa4-86d1-71d5883f9423",
      "name": "OpenAI Chat Model",
      "type": "@n8n/n8n-nodes-langchain.lmChatOpenAi",
      "position": [
        -96,
        32
      ],
      "typeVersion": 1.2,
      "credentials": {
        "openAiApi": {
          "id": "EvxzcLNPSjZ4aV1t",
          "name": "OpenAi account"
        }
      }
    },
    {
      "parameters": {
        "sessionIdType": "customKey",
        "sessionKey": "={{ $json.message }}"
      },
      "id": "9744d167-9599-45a6-8240-1608c378a0af",
      "name": "Window Buffer Memory",
      "type": "@n8n/n8n-nodes-langchain.memoryBufferWindow",
      "position": [
        48,
        32
      ],
      "typeVersion": 1.3
    },
    {
      "parameters": {
        "content": "**Chat Model ‚òùÔ∏è**\nAdd your Open Ai API Key ",
        "height": 80,
        "width": 150,
        "color": 7
      },
      "id": "ca5f9b5f-a0df-43e8-9b99-7289aff6886c",
      "name": "Sticky Note",
      "type": "n8n-nodes-base.stickyNote",
      "position": [
        -144,
        176
      ],
      "typeVersion": 1
    },
    {
      "parameters": {
        "content": "**Gpoogle Calendar ‚òùÔ∏è**\nConnect to Google Calendar",
        "height": 80,
        "width": 190,
        "color": 7
      },
      "id": "f9260635-336d-4ecb-86a1-37ac55c09869",
      "name": "Sticky Note1",
      "type": "n8n-nodes-base.stickyNote",
      "position": [
        224,
        176
      ],
      "typeVersion": 1
    },
    {
      "parameters": {
        "content": "**Google Sheets ‚òùÔ∏è**\nConnect to Google Sheets",
        "height": 80,
        "width": 190,
        "color": 7
      },
      "id": "bb508fc1-b61c-49b8-9f4b-eaa3db10b694",
      "name": "Sticky Note3",
      "type": "n8n-nodes-base.stickyNote",
      "position": [
        480,
        176
      ],
      "typeVersion": 1
    },
    {
      "parameters": {
        "content": "**Memory ‚òùÔ∏è**\nAdd the Session ID ",
        "height": 80,
        "width": 150,
        "color": 7
      },
      "id": "8fea09b0-2f1d-453d-90df-31288e05cf90",
      "name": "Sticky Note4",
      "type": "n8n-nodes-base.stickyNote",
      "position": [
        16,
        176
      ],
      "typeVersion": 1
    },
    {
      "parameters": {
        "resource": "calendar",
        "calendar": {
          "__rl": true,
          "value": "ak.genai23@gmail.com",
          "mode": "list",
          "cachedResultName": "ak.genai23@gmail.com"
        },
        "timeMin": "={{ /*n8n-auto-generated-fromAI-override*/ $fromAI('Start_Time', ``, 'string') }}",
        "timeMax": "={{ /*n8n-auto-generated-fromAI-override*/ $fromAI('End_Time', ``, 'string') }}",
        "options": {}
      },
      "id": "6449f452-4dc8-4fe0-9c82-60debfea46c6",
      "name": "Check Availability",
      "type": "n8n-nodes-base.googleCalendarTool",
      "position": [
        176,
        32
      ],
      "typeVersion": 1.3,
      "credentials": {
        "googleCalendarOAuth2Api": {
          "id": "fh7xsfJ1Fv5AhmgG",
          "name": "Google Calendar account"
        }
      }
    },
    {
      "parameters": {
        "calendar": {
          "__rl": true,
          "value": "ak.genai23@gmail.com",
          "mode": "list",
          "cachedResultName": "ak.genai23@gmail.com"
        },
        "start": "={{ /*n8n-auto-generated-fromAI-override*/ $fromAI('Start', ``, 'string') }}",
        "end": "={{ /*n8n-auto-generated-fromAI-override*/ $fromAI('End', ``, 'string') }}",
        "additionalFields": {
          "description": "Your Dentist appointment",
          "summary": "Doctor Appointment"
        }
      },
      "id": "9570a0b7-0d82-4986-a1bd-a070cfcb8f24",
      "name": "Creat event",
      "type": "n8n-nodes-base.googleCalendarTool",
      "position": [
        336,
        32
      ],
      "typeVersion": 1.3,
      "credentials": {
        "googleCalendarOAuth2Api": {
          "id": "fh7xsfJ1Fv5AhmgG",
          "name": "Google Calendar account"
        }
      }
    },
    {
      "parameters": {
        "operation": "append",
        "documentId": {
          "__rl": true,
          "value": "1-bg_aAVOivkE6x0-3NBPBUMzs-smNUIh4MUHNWrwgMw",
          "mode": "list",
          "cachedResultName": "Appointment",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1-bg_aAVOivkE6x0-3NBPBUMzs-smNUIh4MUHNWrwgMw/edit?usp=drivesdk"
        },
        "sheetName": {
          "__rl": true,
          "value": 823656970,
          "mode": "list",
          "cachedResultName": "Appointment",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1-bg_aAVOivkE6x0-3NBPBUMzs-smNUIh4MUHNWrwgMw/edit#gid=823656970"
        },
        "columns": {
          "mappingMode": "defineBelow",
          "value": {
            "Name": "={{ /*n8n-auto-generated-fromAI-override*/ $fromAI('Name', ``, 'string') }}",
            "Phone": "={{ /*n8n-auto-generated-fromAI-override*/ $fromAI('Phone', ``, 'string') }}",
            "Date/time": "={{ /*n8n-auto-generated-fromAI-override*/ $fromAI('Date_time', ``, 'string') }}"
          },
          "matchingColumns": [],
          "schema": [
            {
              "id": "Name",
              "displayName": "Name",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "Phone",
              "displayName": "Phone",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "Date/time",
              "displayName": "Date/time",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            }
          ],
          "attemptToConvertTypes": false,
          "convertFieldsToString": false
        },
        "options": {}
      },
      "id": "3eed173b-d4b4-4d81-8ed1-b78aa495989e",
      "name": "Add data",
      "type": "n8n-nodes-base.googleSheetsTool",
      "position": [
        480,
        32
      ],
      "typeVersion": 4.5,
      "credentials": {
        "googleSheetsOAuth2Api": {
          "id": "z9vdNGsrAJEJCPSo",
          "name": "Google Sheets account"
        }
      }
    },
    {
      "parameters": {
        "updates": [
          "message"
        ],
        "additionalFields": {}
      },
      "type": "n8n-nodes-base.telegramTrigger",
      "typeVersion": 1.2,
      "position": [
        -288,
        -192
      ],
      "id": "c2786fb8-75fc-4c55-82e7-408bcb8d296f",
      "name": "Telegram Trigger",
      "webhookId": "6ff77197-7cf7-46cb-98d6-89a3c65071a7",
      "credentials": {
        "telegramApi": {
          "id": "VFG3LbmOsjbCAF14",
          "name": "Telegram account"
        }
      }
    },
    {
      "parameters": {
        "chatId": "={{ $('Telegram Trigger').item.json.message.chat.id }}",
        "text": "={{ $json.output }}",
        "additionalFields": {}
      },
      "type": "n8n-nodes-base.telegram",
      "typeVersion": 1.2,
      "position": [
        448,
        -192
      ],
      "id": "e8cf1999-c7fc-463c-8e36-aa03fa9b9e1e",
      "name": "Send a text message",
      "webhookId": "d31973fd-2385-4e0a-9dc8-69d13c6110d1",
      "credentials": {
        "telegramApi": {
          "id": "VFG3LbmOsjbCAF14",
          "name": "Telegram account"
        }
      }
    }
  ],
  "pinData": {},
  "connections": {
    "OpenAI Chat Model": {
      "ai_languageModel": [
        [
          {
            "node": "AI Agent",
            "type": "ai_languageModel",
            "index": 0
          }
        ]
      ]
    },
    "Window Buffer Memory": {
      "ai_memory": [
        [
          {
            "node": "AI Agent",
            "type": "ai_memory",
            "index": 0
          }
        ]
      ]
    },
    "Check Availability": {
      "ai_tool": [
        [
          {
            "node": "AI Agent",
            "type": "ai_tool",
            "index": 0
          }
        ]
      ]
    },
    "Creat event": {
      "ai_tool": [
        [
          {
            "node": "AI Agent",
            "type": "ai_tool",
            "index": 0
          }
        ]
      ]
    },
    "Add data": {
      "ai_tool": [
        [
          {
            "node": "AI Agent",
            "type": "ai_tool",
            "index": 0
          }
        ]
      ]
    },
    "Telegram Trigger": {
      "main": [
        [
          {
            "node": "AI Agent",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "AI Agent": {
      "main": [
        [
          {
            "node": "Send a text message",
            "type": "main",
            "index": 0
          }
        ]
      ]
    }
  },
  "active": true,
  "settings": {
    "executionOrder": "v1"
  },
  "versionId": "a86c1834-63a4-4817-ba70-5190756f7b9a",
  "meta": {
    "templateCredsSetupCompleted": true,
    "instanceId": "922bc857497f3142863a30e18151581dec8b15a19c3c0c72fb9b3f8cda7f73c7"
  },
  "id": "QI49UV7eaE03RHTZ",
  "tags": []
}